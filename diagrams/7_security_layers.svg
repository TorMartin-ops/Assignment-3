<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="layer1" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <linearGradient id="layer2" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e67e22"/>
      <stop offset="100%" style="stop-color:#d35400"/>
    </linearGradient>
    <linearGradient id="layer3" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f39c12"/>
      <stop offset="100%" style="stop-color:#f1c40f"/>
    </linearGradient>
    <linearGradient id="layer4" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2ecc71"/>
      <stop offset="100%" style="stop-color:#27ae60"/>
    </linearGradient>
    <linearGradient id="layer5" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="layer6" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <linearGradient id="layer7" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#34495e"/>
      <stop offset="100%" style="stop-color:#2c3e50"/>
    </linearGradient>
    <linearGradient id="layer8" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1e3c72"/>
      <stop offset="100%" style="stop-color:#2a5298"/>
    </linearGradient>
  </defs>

  <text x="400" y="30" text-anchor="middle" font-size="16" font-weight="bold" fill="#1e3c72">
    Defense-in-Depth: Eight Security Layers
  </text>

  <!-- Layer 8: Audit -->
  <rect x="100" y="470" width="600" height="60" fill="url(#layer8)" opacity="0.9" rx="5"/>
  <text x="400" y="495" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 8: Audit Logging</text>
  <text x="400" y="512" text-anchor="middle" fill="white" font-size="10">security_events table | login_attempts tracking</text>

  <!-- Layer 7: Data Protection -->
  <rect x="120" y="410" width="560" height="60" fill="url(#layer7)" opacity="0.9" rx="5"/>
  <text x="400" y="435" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 7: Data Protection</text>
  <text x="400" y="452" text-anchor="middle" fill="white" font-size="10">Fernet encryption | Parameterized queries | Backup code hashing</text>

  <!-- Layer 6: Session Security -->
  <rect x="140" y="350" width="520" height="60" fill="url(#layer6)" opacity="0.9" rx="5"/>
  <text x="400" y="375" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 6: Session Security</text>
  <text x="400" y="392" text-anchor="middle" fill="white" font-size="10">Encrypted cookies | CSRF tokens | SameSite attributes</text>

  <!-- Layer 5: Rate Limiting -->
  <rect x="160" y="290" width="480" height="60" fill="url(#layer5)" opacity="0.9" rx="5"/>
  <text x="400" y="315" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 5: Rate Limiting & Lockout</text>
  <text x="400" y="332" text-anchor="middle" fill="white" font-size="10">5 req/min throttling | 3-failure lockout | reCAPTCHA</text>

  <!-- Layer 4: 2FA -->
  <rect x="180" y="230" width="440" height="60" fill="url(#layer4)" opacity="0.9" rx="5"/>
  <text x="400" y="255" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 4: Two-Factor Authentication</text>
  <text x="400" y="272" text-anchor="middle" fill="white" font-size="10">TOTP (RFC 6238) | Replay prevention | Backup codes</text>

  <!-- Layer 3: Authentication -->
  <rect x="200" y="170" width="400" height="60" fill="url(#layer3)" opacity="0.9" rx="5"/>
  <text x="400" y="195" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 3: Authentication</text>
  <text x="400" y="212" text-anchor="middle" fill="white" font-size="10">Argon2id (19 MiB) | Timing-safe verification | Breach detection</text>

  <!-- Layer 2: Input Validation -->
  <rect x="220" y="110" width="360" height="60" fill="url(#layer2)" opacity="0.9" rx="5"/>
  <text x="400" y="135" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 2: Input Validation</text>
  <text x="400" y="152" text-anchor="middle" fill="white" font-size="10">Regex validation | Length checks | XSS sanitization (bleach)</text>

  <!-- Layer 1: Transport Security -->
  <rect x="240" y="50" width="320" height="60" fill="url(#layer1)" opacity="0.9" rx="5"/>
  <text x="400" y="75" text-anchor="middle" fill="white" font-weight="bold" font-size="12">Layer 1: Transport Security</text>
  <text x="400" y="92" text-anchor="middle" fill="white" font-size="10">HSTS | CSP headers | X-Frame-Options | TLS enforcement</text>

  <!-- Attack arrows (stopped at each layer) -->
  <g opacity="0.6">
    <line x1="50" y1="80" x2="240" y2="80" stroke="#dc3545" stroke-width="3" stroke-dasharray="10,5"/>
    <polygon points="240 80, 230 75, 230 85" fill="#dc3545"/>
    <text x="145" y="75" text-anchor="middle" font-size="10" fill="#dc3545" font-weight="bold">Attack</text>

    <line x1="70" y1="140" x2="220" y2="140" stroke="#dc3545" stroke-width="3" stroke-dasharray="10,5"/>
    <polygon points="220 140, 210 135, 210 145" fill="#dc3545"/>

    <line x1="90" y1="200" x2="200" y2="200" stroke="#dc3545" stroke-width="3" stroke-dasharray="10,5"/>
    <polygon points="200 200, 190 195, 190 205" fill="#dc3545"/>
  </g>

  <!-- Labels -->
  <text x="50" y="550" font-size="10" font-weight="bold">Attacker Entry Points:</text>
  <text x="50" y="568" font-size="9">• HTTP requests intercepted (Layer 1)</text>
  <text x="50" y="583" font-size="9">• Malicious input submitted (Layer 2)</text>
  <text x="250" y="568" font-size="9">• Stolen passwords used (Layer 3)</text>
  <text x="250" y="583" font-size="9">• Phishing attacks (Layer 4)</text>
  <text x="450" y="568" font-size="9">• Brute force attempts (Layer 5)</text>
  <text x="450" y="583" font-size="9">• Session hijacking (Layer 6)</text>

  <!-- Legend -->
  <rect x="50" y="550" width="700" height="45" fill="#f8f9fa" stroke="#666"/>
  <text x="60" y="568" font-size="10" font-weight="bold">Defense Principle:</text>
  <text x="165" y="568" font-size="10">Each layer provides independent protection. Compromise of one layer does not compromise entire system.</text>
  <text x="60" y="585" font-size="9">Total Controls: 28 mechanisms across 8 layers | Test Coverage: 16/16 attack tests passed</text>
</svg>